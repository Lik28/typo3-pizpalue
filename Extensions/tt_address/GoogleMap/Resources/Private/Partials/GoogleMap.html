<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      xmlns:pp="http://typo3.org/ns/Buepro/Pizpalue/ViewHelpers" data-namespace-typo3-fluid="true">

{pp:filterArray(source: addresses,
    keylist: 'uid,company,latitude,longitude,title,name,phone,email,www,description,image')
    -> f:format.json(forceObject: 'true')
    -> f:variable(name: 'jsonData')}

<h1>Google map goes here</h1>

<div class="pp-ttaddress-map" data-pp-addresses="{jsonData}">
</div>
<div class="pp-ttaddress-maptemplate" data-pp-amt-markertitle="company">
    <div class="pp-amt-wrap" data-pp-amt-uid="uid">
        <div class="pp-amt-imagewrap">
            <img class="pp-amt-image" src="" data-pp-amt="image" />
        </div>
        <div class="pp-amt-text">
            <h6><span data-pp-amt="company"></span>&nbsp;(<span data-pp-amt="title"></span>)</h6>
            <p data-pp-amt="description"></p>
            <p>
                <b data-pp-amt="name"></b><br />
                Tel: <span data-pp-amt="phone"></span>&nbsp;|&nbsp;
                <a href="#" data-pp-amt="email">Email</a>&nbsp;|&nbsp;
                <a href="#" target="_blank" data-pp-amt="www">Web</a>
            </p>
        </div>
    </div>
</div>
<div class="pp-ttaddress-mapimages">
    <f:for each="{addresses}" as="address">
        <f:if condition="{address.image}">
            <i data-pp-ami="{address.uid}"><f:uri.image image="{address.firstImage}" width="150"/></i>
        </f:if>
    </f:for>
</div>

</html>